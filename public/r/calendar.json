{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "calendar",
  "dependencies": ["@corvu/calendar", "lucide-solid"],
  "registryDependencies": ["button"],
  "files": [
    {
      "path": "src/registry/kobalte/ui/calendar.tsx",
      "content": "import Calendar from \"@corvu/calendar\";\nimport { getWeek } from \"date-fns\";\nimport { ChevronLeft, ChevronRight } from \"lucide-solid\";\nimport { type ComponentProps, Index, type JSX, mergeProps, Show, splitProps } from \"solid-js\";\nimport { cn } from \"@/lib/utils\";\nimport { Button, buttonVariants } from \"@/registry/kobalte/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/registry/kobalte/ui/select\";\n\ntype CalendarSingleValue = Date | null;\ntype CalendarMultipleValue = Date[];\ntype CalendarRangeValue = { from: Date | null; to: Date | null };\n\n/**\n * Props passed to the customCell render function\n */\ntype CustomCellProps = {\n  /** The date of the cell */\n  date: Date;\n  /** Whether the date is outside the current month */\n  isOutsideMonth: boolean;\n  /** Whether the date is selected */\n  isSelected: boolean;\n  /** Whether the date is disabled */\n  isDisabled: boolean;\n  /** Whether the date is today */\n  isToday: boolean;\n};\n\ntype CalendarBaseProps = Omit<ComponentProps<\"div\">, \"onChange\"> & {\n  /**\n   * Whether to show days from the previous/next months\n   * @default true\n   */\n  showOutsideDays?: boolean;\n  /**\n   * Whether to always show 6 weeks in the calendar\n   * @default false\n   */\n  fixedWeeks?: boolean;\n  /**\n   * Number of months to display\n   * @default 1\n   */\n  numberOfMonths?: number;\n  /**\n   * Function to disable specific dates (grayed out, not selectable)\n   */\n  disabled?: (date: Date) => boolean;\n  /**\n   * Function to mark specific dates as booked (strikethrough styling)\n   * Booked dates are also disabled but have different visual styling\n   */\n  booked?: (date: Date) => boolean;\n  /**\n   * The controlled month to display\n   */\n  month?: Date;\n  /**\n   * Callback when the displayed month changes\n   */\n  onMonthChange?: (month: Date) => void;\n  /**\n   * The initial month to display (uncontrolled)\n   */\n  defaultMonth?: Date;\n  /**\n   * Which day of the week to start on (0 = Sunday, 1 = Monday, etc.)\n   * @default 1\n   */\n  weekStartsOn?: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  /**\n   * Whether to show week numbers in the calendar\n   * @default false\n   */\n  weekNumbers?: boolean;\n  /**\n   * Custom render function for day cells\n   * Allows adding metadata like prices, events, etc.\n   */\n  customCell?: (props: CustomCellProps) => JSX.Element;\n  /**\n   * Enable month/year selection via dropdown selects\n   * @default false\n   */\n  monthYearSelection?: boolean;\n  /**\n   * Start year for the year dropdown (only used when monthYearSelection is true)\n   * @default current year - 100\n   */\n  startYear?: number;\n  /**\n   * End year for the year dropdown (only used when monthYearSelection is true)\n   * @default current year + 10\n   */\n  endYear?: number;\n};\n\ntype CalendarSingleProps = CalendarBaseProps & {\n  mode?: \"single\";\n  value?: CalendarSingleValue;\n  onValueChange?: (value: CalendarSingleValue) => void;\n  defaultValue?: CalendarSingleValue;\n};\n\ntype CalendarMultipleProps = CalendarBaseProps & {\n  mode: \"multiple\";\n  value?: CalendarMultipleValue;\n  onValueChange?: (value: CalendarMultipleValue) => void;\n  defaultValue?: CalendarMultipleValue;\n};\n\ntype CalendarRangeProps = CalendarBaseProps & {\n  mode: \"range\";\n  value?: CalendarRangeValue;\n  onValueChange?: (value: CalendarRangeValue) => void;\n  defaultValue?: CalendarRangeValue;\n};\n\ntype CalendarProps = CalendarSingleProps | CalendarMultipleProps | CalendarRangeProps;\n\nconst MONTHS = [\n  { label: \"January\", value: 0 },\n  { label: \"February\", value: 1 },\n  { label: \"March\", value: 2 },\n  { label: \"April\", value: 3 },\n  { label: \"May\", value: 4 },\n  { label: \"June\", value: 5 },\n  { label: \"July\", value: 6 },\n  { label: \"August\", value: 7 },\n  { label: \"September\", value: 8 },\n  { label: \"October\", value: 9 },\n  { label: \"November\", value: 10 },\n  { label: \"December\", value: 11 },\n];\n\nconst CalendarComponent = (props: CalendarProps) => {\n  const currentYear = new Date().getFullYear();\n\n  const mergedProps = mergeProps(\n    {\n      mode: \"single\" as const,\n      showOutsideDays: true,\n      fixedWeeks: false,\n      numberOfMonths: 1,\n      weekStartsOn: 1 as const,\n      weekNumbers: false,\n      monthYearSelection: false,\n      startYear: currentYear - 100,\n      endYear: currentYear + 10,\n    },\n    props,\n  );\n\n  const [local, others] = splitProps(mergedProps, [\n    \"class\",\n    \"mode\",\n    \"value\",\n    \"onValueChange\",\n    \"defaultValue\",\n    \"showOutsideDays\",\n    \"fixedWeeks\",\n    \"numberOfMonths\",\n    \"disabled\",\n    \"booked\",\n    \"month\",\n    \"onMonthChange\",\n    \"defaultMonth\",\n    \"weekStartsOn\",\n    \"weekNumbers\",\n    \"customCell\",\n    \"monthYearSelection\",\n    \"startYear\",\n    \"endYear\",\n  ]);\n\n  const formatMonth = (date: Date) => {\n    return date.toLocaleString(\"default\", { month: \"long\", year: \"numeric\" });\n  };\n\n  const formatWeekday = (date: Date) => {\n    return date.toLocaleString(\"default\", { weekday: \"short\" }).slice(0, 2);\n  };\n\n  // Generate years array for dropdown\n  const years = () =>\n    Array.from({ length: local.endYear - local.startYear + 1 }, (_, i) => {\n      const year = local.startYear + i;\n      return { label: year.toString(), value: year };\n    });\n\n  return (\n    // @ts-expect-error - Calendar component is not typed correctly\n    <Calendar\n      mode={local.mode}\n      value={local.value as Date | null}\n      onValueChange={local.onValueChange as (value: Date | null) => void}\n      initialValue={local.defaultValue as Date | null}\n      month={local.month}\n      onMonthChange={local.onMonthChange}\n      initialMonth={local.defaultMonth}\n      numberOfMonths={local.numberOfMonths}\n      fixedWeeks={local.fixedWeeks}\n      disableOutsideDays={!local.showOutsideDays}\n      disabled={(date: Date) => local.disabled?.(date) || local.booked?.(date) || false}\n      startOfWeek={local.weekStartsOn}\n    >\n      {/* @ts-expect-error - Calendar component is not typed correctly */}\n      {(calendarProps) => (\n        <div\n          data-slot=\"calendar\"\n          class={cn(\n            \"cn-calendar group/calendar w-fit bg-popover p-3\",\n            \"in-data-[slot=card-content]:bg-transparent in-data-[slot=popover-content]:bg-transparent\",\n            local.class,\n          )}\n          {...others}\n        >\n          <div class=\"flex flex-col gap-4 md:flex-row\">\n            <Index each={calendarProps.months}>\n              {(monthData, index) => (\n                <div data-slot=\"calendar-month\" class=\"flex w-full flex-col gap-4\">\n                  {/* Navigation and Header */}\n                  <nav\n                    data-slot=\"calendar-header\"\n                    class=\"flex h-(--cell-size) w-full items-center justify-between gap-1\"\n                  >\n                    <Calendar.Nav\n                      action=\"prev-month\"\n                      as={Button}\n                      variant=\"ghost\"\n                      class={cn(\n                        buttonVariants({ variant: \"ghost\" }),\n                        \"size-(--cell-size) select-none p-0\",\n                      )}\n                    >\n                      <ChevronLeft class=\"size-4\" />\n                      <span class=\"sr-only\">Previous month</span>\n                    </Calendar.Nav>\n\n                    {/* Month/Year Selection or Label */}\n                    <Show\n                      when={local.monthYearSelection}\n                      fallback={\n                        <h2\n                          class=\"flex-1 select-none text-center font-medium text-sm\"\n                          data-slot=\"calendar-label\"\n                          id={calendarProps.labelIds[index]?.()}\n                        >\n                          {formatMonth(monthData().month)}\n                        </h2>\n                      }\n                    >\n                      <div class=\"flex flex-1 items-center justify-center gap-2\">\n                        <Select<(typeof MONTHS)[number]>\n                          options={MONTHS}\n                          optionValue=\"value\"\n                          optionTextValue=\"label\"\n                          value={MONTHS.find((m) => m.value === monthData().month.getMonth())}\n                          onChange={(selectedMonth) => {\n                            if (selectedMonth) {\n                              const newDate = new Date(monthData().month);\n                              newDate.setMonth(selectedMonth.value);\n                              calendarProps.setMonth(newDate);\n                            }\n                          }}\n                          itemComponent={(itemProps) => (\n                            <SelectItem item={itemProps.item}>\n                              {itemProps.item.rawValue.label}\n                            </SelectItem>\n                          )}\n                        >\n                          <SelectTrigger size=\"sm\" class=\"h-7 w-[110px]\">\n                            <SelectValue<(typeof MONTHS)[number]>>\n                              {(state) => state.selectedOption().label}\n                            </SelectValue>\n                          </SelectTrigger>\n                          <SelectContent />\n                        </Select>\n                        <Select<{ label: string; value: number }>\n                          options={years()}\n                          optionValue=\"value\"\n                          optionTextValue=\"label\"\n                          value={years().find((y) => y.value === monthData().month.getFullYear())}\n                          onChange={(selectedYear) => {\n                            if (selectedYear) {\n                              const newDate = new Date(monthData().month);\n                              newDate.setFullYear(selectedYear.value);\n                              calendarProps.setMonth(newDate);\n                            }\n                          }}\n                          itemComponent={(itemProps) => (\n                            <SelectItem item={itemProps.item}>\n                              {itemProps.item.rawValue.label}\n                            </SelectItem>\n                          )}\n                        >\n                          <SelectTrigger size=\"sm\" class=\"h-7 w-[80px]\">\n                            <SelectValue<{ label: string; value: number }>>\n                              {(state) => state.selectedOption().label}\n                            </SelectValue>\n                          </SelectTrigger>\n                          <SelectContent />\n                        </Select>\n                      </div>\n                    </Show>\n\n                    <Calendar.Nav\n                      action=\"next-month\"\n                      as={Button}\n                      variant=\"ghost\"\n                      class={cn(\n                        buttonVariants({ variant: \"ghost\" }),\n                        \"size-(--cell-size) select-none p-0\",\n                      )}\n                    >\n                      <ChevronRight class=\"size-4\" />\n                      <span class=\"sr-only\">Next month</span>\n                    </Calendar.Nav>\n                  </nav>\n\n                  <Calendar.Table index={index} class=\"w-full border-collapse\">\n                    <thead data-slot=\"calendar-weekdays\">\n                      <tr class=\"flex\">\n                        {/* Week number header */}\n                        <Show when={local.weekNumbers}>\n                          <th\n                            data-slot=\"calendar-week-number-header\"\n                            class=\"w-8 flex-none select-none rounded-(--cell-radius) font-normal text-[0.8rem] text-muted-foreground\"\n                          >\n                            #\n                          </th>\n                        </Show>\n                        <Index each={calendarProps.weekdays}>\n                          {(weekday) => (\n                            <Calendar.HeadCell\n                              data-slot=\"calendar-weekday\"\n                              class=\"flex-1 select-none rounded-(--cell-radius) font-normal text-[0.8rem] text-muted-foreground\"\n                            >\n                              {formatWeekday(weekday())}\n                            </Calendar.HeadCell>\n                          )}\n                        </Index>\n                      </tr>\n                    </thead>\n                    <tbody data-slot=\"calendar-weeks\">\n                      <Index each={monthData().weeks}>\n                        {(week) => (\n                          <tr data-slot=\"calendar-week\" class=\"mt-2 flex w-full\">\n                            {/* Week number cell */}\n                            <Show when={local.weekNumbers}>\n                              <td\n                                data-slot=\"calendar-week-number\"\n                                class=\"flex w-8 flex-none select-none items-center justify-center font-normal text-[0.75rem] text-muted-foreground\"\n                              >\n                                {getWeekNumber(week())}\n                              </td>\n                            </Show>\n                            <Index each={week()}>\n                              {(day) => (\n                                <Show when={day()} fallback={<td class=\"flex-1 p-0\" />}>\n                                  {(d) => (\n                                    <CalendarDay\n                                      day={d()}\n                                      month={monthData().month}\n                                      mode={local.mode}\n                                      value={calendarProps.value}\n                                      disabled={local.disabled}\n                                      booked={local.booked}\n                                      customCell={local.customCell}\n                                    />\n                                  )}\n                                </Show>\n                              )}\n                            </Index>\n                          </tr>\n                        )}\n                      </Index>\n                    </tbody>\n                  </Calendar.Table>\n                </div>\n              )}\n            </Index>\n          </div>\n        </div>\n      )}\n    </Calendar>\n  );\n};\n\n/**\n * Get the ISO week number for a week (using the first non-null day)\n */\nconst getWeekNumber = (week: (Date | null)[]): number => {\n  const firstDay = week.find((d) => d !== null);\n  if (!firstDay) return 0;\n  return getWeek(firstDay, { weekStartsOn: 1 });\n};\n\ntype CalendarDayProps = {\n  day: Date;\n  month: Date;\n  mode: \"single\" | \"multiple\" | \"range\";\n  value: Date | null | Date[] | { from: Date | null; to: Date | null };\n  disabled?: (date: Date) => boolean;\n  booked?: (date: Date) => boolean;\n  customCell?: (props: CustomCellProps) => JSX.Element;\n};\n\nconst CalendarDay = (props: CalendarDayProps) => {\n  const isOutsideMonth = () => props.day.getMonth() !== props.month.getMonth();\n  const isToday = () => isSameDay(props.day, new Date());\n  const isDisabled = () => props.disabled?.(props.day) ?? false;\n  const isBooked = () => props.booked?.(props.day) ?? false;\n\n  const isSelected = () => {\n    const value = props.value;\n    if (value === null || value === undefined) return false;\n\n    if (value instanceof Date) {\n      return isSameDay(value, props.day);\n    }\n    if (Array.isArray(value)) {\n      return value.some((d) => isSameDay(d, props.day));\n    }\n    if (typeof value === \"object\" && \"from\" in value) {\n      const { from, to } = value as CalendarRangeValue;\n      if (from && isSameDay(from, props.day)) return true;\n      if (to && isSameDay(to, props.day)) return true;\n      return false;\n    }\n    return false;\n  };\n\n  const isRangeStart = () => {\n    const value = props.value;\n    if (!value || typeof value !== \"object\" || !(\"from\" in value)) return false;\n    const { from } = value as CalendarRangeValue;\n    return from && isSameDay(from, props.day);\n  };\n\n  const isRangeEnd = () => {\n    const value = props.value;\n    if (!value || typeof value !== \"object\" || !(\"from\" in value)) return false;\n    const { to } = value as CalendarRangeValue;\n    return to && isSameDay(to, props.day);\n  };\n\n  const isInRange = () => {\n    const value = props.value;\n    if (!value || typeof value !== \"object\" || !(\"from\" in value)) return false;\n    const { from, to } = value as CalendarRangeValue;\n    if (!from || !to) return false;\n    return props.day > from && props.day < to;\n  };\n\n  const isSingleSelected = () => isSelected() && !isRangeStart() && !isRangeEnd() && !isInRange();\n\n  return (\n    <Calendar.Cell\n      data-slot=\"calendar-day\"\n      class={cn(\n        \"group/day relative aspect-square h-full w-full flex-1 select-none rounded-(--cell-radius) p-0 text-center\",\n        \"[&:first-child[data-selected=true]_button]:rounded-l-(--cell-radius)\",\n        \"[&:last-child[data-selected=true]_button]:rounded-r-(--cell-radius)\",\n        isRangeStart() &&\n          \"isolate z-0 rounded-l-(--cell-radius) bg-muted after:absolute after:inset-y-0 after:right-0 after:w-4 after:bg-muted\",\n        isRangeEnd() &&\n          \"isolate z-0 rounded-r-(--cell-radius) bg-muted after:absolute after:inset-y-0 after:left-0 after:w-4 after:bg-muted\",\n        isInRange() && \"rounded-none\",\n      )}\n      data-selected={isSelected() || undefined}\n      data-outside={isOutsideMonth() || undefined}\n    >\n      <Calendar.CellTrigger\n        day={props.day}\n        month={props.month}\n        data-slot=\"calendar-day-button\"\n        class={cn(\n          buttonVariants({ variant: \"ghost\", size: \"icon\" }),\n          \"relative isolate z-10 flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-0.5 border-0 font-normal leading-none\",\n          // Focus states\n          \"group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-[3px] group-data-[focused=true]/day:ring-ring/50\",\n          // Today styling\n          \"data-[today=true]:data-[selected=true]:rounded-none data-[today=true]:rounded-(--cell-radius) data-[today=true]:bg-muted data-[today=true]:text-foreground\",\n          // Single selection\n          isSingleSelected() && \"bg-primary text-primary-foreground\",\n          // Range selection\n          isRangeStart() &&\n            \"rounded-(--cell-radius) rounded-l-(--cell-radius) bg-primary text-primary-foreground\",\n          isRangeEnd() &&\n            \"rounded-(--cell-radius) rounded-r-(--cell-radius) bg-primary text-primary-foreground\",\n          isInRange() && \"rounded-none bg-muted text-foreground\",\n          // Outside month\n          \"data-[outside=true]:text-muted-foreground data-[outside=true]:aria-selected:text-muted-foreground\",\n          // Disabled (not selectable, grayed out)\n          \"data-disabled:text-muted-foreground data-disabled:opacity-50\",\n          // Booked (strikethrough styling)\n          isBooked() && \"line-through\",\n          // Custom cell styling - add padding if custom cell is provided\n          props.customCell && \"h-auto min-h-(--cell-size) py-1\",\n        )}\n        data-outside={isOutsideMonth() || undefined}\n      >\n        <span>{props.day.getDate()}</span>\n        <Show when={props.customCell}>\n          {(renderCustomCell) =>\n            renderCustomCell()({\n              date: props.day,\n              isOutsideMonth: isOutsideMonth(),\n              isSelected: isSelected(),\n              isDisabled: isDisabled(),\n              isToday: isToday(),\n            })\n          }\n        </Show>\n      </Calendar.CellTrigger>\n    </Calendar.Cell>\n  );\n};\n\n// Helper function\nconst isSameDay = (a: Date, b: Date): boolean => {\n  return (\n    a.getFullYear() === b.getFullYear() &&\n    a.getMonth() === b.getMonth() &&\n    a.getDate() === b.getDate()\n  );\n};\n\nexport { CalendarComponent as Calendar, type CalendarProps, type CustomCellProps };\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}
